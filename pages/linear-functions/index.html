<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linear Functions Visualization</title>
    <!-- Load React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <!-- Load Babel for JSX support -->
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <!-- Use d3 instead of Recharts for more reliable visualization -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        .container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .control-panel {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f5f5f5;
            border-radius: 8px;
        }
        .function-input {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }
        .chart-container {
            height: 400px;
            width: 100%;
            border: 1px solid #ccc;
            border-radius: 4px;
            overflow: hidden;
        }
        input[type="number"] {
            width: 60px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        label {
            font-weight: bold;
        }
        .formula {
            font-style: italic;
            margin-left: 10px;
        }
        .function-card {
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 15px;
        }
        button {
            padding: 8px 12px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .svg-container {
            width: 100%;
            height: 100%;
        }
        .axis line, .axis path {
            stroke: #000;
        }
        .grid line {
            stroke: lightgrey;
            stroke-opacity: 0.7;
            shape-rendering: crispEdges;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Main application component
        const LinearFunctionsApp = () => {
            // State for the linear functions
            const [functions, setFunctions] = useState([
                { id: 1, slope: 2, intercept: 0, color: '#8884d8', visible: true },
                { id: 2, slope: -1, intercept: 5, color: '#82ca9d', visible: true },
                { id: 3, slope: 0.5, intercept: -3, color: '#ffc658', visible: true }
            ]);
            
            // State for the x-axis range
            const [range, setRange] = useState({ min: -10, max: 10 });
            
            // Reference to chart container
            const chartRef = useRef(null);
            
            // Handler for changing function parameters
            const handleFunctionChange = (id, field, value) => {
                setFunctions(functions.map(f => 
                    f.id === id ? { ...f, [field]: parseFloat(value) } : f
                ));
            };
            
            // Handler for toggling function visibility
            const toggleFunctionVisibility = (id) => {
                setFunctions(functions.map(f => 
                    f.id === id ? { ...f, visible: !f.visible } : f
                ));
            };
            
            // Handler for changing the x-axis range
            const handleRangeChange = (field, value) => {
                setRange({ ...range, [field]: parseInt(value) });
            };
            
            // Handler for adding a new function
            const addNewFunction = () => {
                const newId = Math.max(...functions.map(f => f.id), 0) + 1;
                const colors = ['#ff7300', '#0088FE', '#00C49F', '#FFBB28', '#FF8042'];
                const randomColor = colors[Math.floor(Math.random() * colors.length)];
                
                setFunctions([
                    ...functions, 
                    { id: newId, slope: 1, intercept: 0, color: randomColor, visible: true }
                ]);
            };
            
            // Handler for removing a function
            const removeFunction = (id) => {
                if (functions.length > 1) {
                    setFunctions(functions.filter(f => f.id !== id));
                }
            };

            // Draw the chart using D3
            useEffect(() => {
                if (!chartRef.current) return;
                
                // Clear previous chart
                d3.select(chartRef.current).selectAll("*").remove();
                
                // Set up dimensions
                const margin = { top: 20, right: 30, bottom: 40, left: 50 };
                const width = chartRef.current.clientWidth - margin.left - margin.right;
                const height = chartRef.current.clientHeight - margin.top - margin.bottom;
                
                // Create SVG
                const svg = d3.select(chartRef.current)
                    .append("svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", `translate(${margin.left},${margin.top})`);
                
                // Create scales
                const x = d3.scaleLinear()
                    .domain([range.min, range.max])
                    .range([0, width]);
                
                // Calculate y domain based on functions
                let yMin = Infinity;
                let yMax = -Infinity;
                
                functions.forEach(func => {
                    if (func.visible) {
                        const y1 = func.slope * range.min + func.intercept;
                        const y2 = func.slope * range.max + func.intercept;
                        yMin = Math.min(yMin, y1, y2);
                        yMax = Math.max(yMax, y1, y2);
                    }
                });
                
                // Add padding to y domain
                const yPadding = (yMax - yMin) * 0.1;
                yMin = yMin - yPadding;
                yMax = yMax + yPadding;
                
                const y = d3.scaleLinear()
                    .domain([yMin, yMax])
                    .range([height, 0]);
                
                // Add X and Y axes
                svg.append("g")
                    .attr("class", "axis")
                    .attr("transform", `translate(0,${y(0)})`)
                    .call(d3.axisBottom(x));
                
                svg.append("g")
                    .attr("class", "axis")
                    .attr("transform", `translate(${x(0)},0)`)
                    .call(d3.axisLeft(y));
                
                // Add grid
                svg.append("g")
                    .attr("class", "grid")
                    .attr("transform", `translate(0,${height})`)
                    .call(d3.axisBottom(x)
                        .tickSize(-height)
                        .tickFormat("")
                    );
                
                svg.append("g")
                    .attr("class", "grid")
                    .call(d3.axisLeft(y)
                        .tickSize(-width)
                        .tickFormat("")
                    );
                
                // Draw lines for each function
                functions.forEach(func => {
                    if (func.visible) {
                        // Line generator
                        const line = d3.line()
                            .x(d => x(d))
                            .y(d => y(func.slope * d + func.intercept));
                        
                        // Draw line
                        svg.append("path")
                            .datum([range.min, range.max])
                            .attr("fill", "none")
                            .attr("stroke", func.color)
                            .attr("stroke-width", 2)
                            .attr("d", line);
                        
                        // Add label
                        const midX = (range.min + range.max) / 2;
                        const midY = func.slope * midX + func.intercept;
                        
                        svg.append("text")
                            .attr("x", x(midX) + 10)
                            .attr("y", y(midY) - 10)
                            .attr("fill", func.color)
                            .text(`f${func.id}(x) = ${func.slope}x ${func.intercept >= 0 ? `+ ${func.intercept}` : func.intercept}`);
                    }
                });
                
                // Add axis labels
                svg.append("text")
                    .attr("text-anchor", "end")
                    .attr("x", width)
                    .attr("y", height + margin.bottom - 5)
                    .text("X");
                
                svg.append("text")
                    .attr("text-anchor", "end")
                    .attr("transform", "rotate(-90)")
                    .attr("y", -margin.left + 15)
                    .attr("x", -margin.top)
                    .text("Y");
                
            }, [functions, range]);

            return (
                <div className="container">
                    <h1>Linear Functions Explorer</h1>
                    <p>Explore linear functions of the form f(x) = mx + b where m is the slope and b is the y-intercept.</p>
                    
                    <div className="control-panel">
                        <div>
                            <label>X-Axis Range:</label>
                            <div>
                                <input 
                                    type="number" 
                                    value={range.min} 
                                    onChange={(e) => handleRangeChange('min', e.target.value)}
                                    min="-100" 
                                    max="0"
                                />
                                <span> to </span>
                                <input 
                                    type="number" 
                                    value={range.max} 
                                    onChange={(e) => handleRangeChange('max', e.target.value)}
                                    min="0" 
                                    max="100"
                                />
                            </div>
                        </div>
                    </div>
                    
                    <div className="functions-container">
                        <h2>Functions</h2>
                        {functions.map(func => (
                            <div key={func.id} className="function-card" style={{ backgroundColor: `${func.color}20` }}>
                                <div className="function-input">
                                    <input
                                        type="checkbox"
                                        checked={func.visible}
                                        onChange={() => toggleFunctionVisibility(func.id)}
                                    />
                                    <label>
                                        Function {func.id}: f(x) = 
                                    </label>
                                    <input
                                        type="number"
                                        value={func.slope}
                                        onChange={(e) => handleFunctionChange(func.id, 'slope', e.target.value)}
                                        step="0.5"
                                    />
                                    <span>x + </span>
                                    <input
                                        type="number"
                                        value={func.intercept}
                                        onChange={(e) => handleFunctionChange(func.id, 'intercept', e.target.value)}
                                        step="1"
                                    />
                                    <span className="formula">
                                        y = {func.slope}x {func.intercept >= 0 ? `+ ${func.intercept}` : func.intercept}
                                    </span>
                                    <button onClick={() => removeFunction(func.id)}>Remove</button>
                                </div>
                            </div>
                        ))}
                        <button onClick={addNewFunction}>Add New Function</button>
                    </div>
                    
                    <div className="chart-container" ref={chartRef}></div>
                    
                    <div>
                        <h2>About Linear Functions</h2>
                        <p>A linear function is a function whose graph is a straight line. The general form is f(x) = mx + b, where:</p>
                        <ul>
                            <li><strong>m</strong> is the slope of the line</li>
                            <li><strong>b</strong> is the y-intercept (where the line crosses the y-axis)</li>
                        </ul>
                        <p>Key properties of linear functions:</p>
                        <ul>
                            <li>When m > 0, the line slopes upward as x increases (positive slope)</li>
                            <li>When m < 0, the line slopes downward as x increases (negative slope)</li>
                            <li>When m = 0, the line is horizontal (constant function)</li>
                            <li>The larger the absolute value of m, the steeper the slope</li>
                        </ul>
                    </div>
                </div>
            );
        };

        // Render the app
        ReactDOM.render(<LinearFunctionsApp />, document.getElementById('root'));
    </script>
</body>
</html>